<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fast radiocarbon calibration — BchronCalibrate • Bchron</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fast radiocarbon calibration — BchronCalibrate"><meta property="og:description" content="A fast function for calibrating large numbers of radiocarbon dates involving multiple calibration curves"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bchron</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.7.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Bchron.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/andrewcparnell/Bchron/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast radiocarbon calibration</h1>
    <small class="dont-index">Source: <a href="https://github.com/andrewcparnell/Bchron/blob/master/R/BchronCalibrate.R" class="external-link"><code>R/BchronCalibrate.R</code></a></small>
    <div class="hidden name"><code>BchronCalibrate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A fast function for calibrating large numbers of radiocarbon dates involving multiple calibration curves</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">BchronCalibrate</span><span class="op">(</span></span>
<span>  <span class="va">ages</span>,</span>
<span>  <span class="va">ageSds</span>,</span>
<span>  calCurves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"intcal20"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ages</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  positions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pathToCalCurves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"data"</span>, package <span class="op">=</span> <span class="st">"Bchron"</span><span class="op">)</span>,</span>
<span>  allowOutside <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  dfs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ages</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-ages">ages<a class="anchor" aria-label="anchor" href="#arg-ages"></a></dt>
<dd><p>A vector of ages provided in years before 1950.</p></dd>


<dt id="arg-agesds">ageSds<a class="anchor" aria-label="anchor" href="#arg-agesds"></a></dt>
<dd><p>A vector of 1-sigma values for the ages given above</p></dd>


<dt id="arg-calcurves">calCurves<a class="anchor" aria-label="anchor" href="#arg-calcurves"></a></dt>
<dd><p>A vector of values containing either <code>intcal20</code>, <code>shcal20</code>, <code>marine20</code>, or <code>normal</code> (older calibration curves are supposed such as intcal13). Should be the same length the number of ages supplied. Non-standard calibration curves can be used provided they are supplied in the same format as those previously mentioned and are placed in the same directory. Normal indicates a normally-distributed (non-14C) age.</p></dd>


<dt id="arg-ids">ids<a class="anchor" aria-label="anchor" href="#arg-ids"></a></dt>
<dd><p>ID names for each age</p></dd>


<dt id="arg-positions">positions<a class="anchor" aria-label="anchor" href="#arg-positions"></a></dt>
<dd><p>Position values (e.g. depths) for each age. In the case of layers of non-zero thickness, this should be the middle value of the slice</p></dd>


<dt id="arg-pathtocalcurves">pathToCalCurves<a class="anchor" aria-label="anchor" href="#arg-pathtocalcurves"></a></dt>
<dd><p>File path to where the calibration curves are located. Defaults to the system directory where the 3 standard calibration curves are stored.</p></dd>


<dt id="arg-allowoutside">allowOutside<a class="anchor" aria-label="anchor" href="#arg-allowoutside"></a></dt>
<dd><p>Whether to allow calibrations to run outside the range of the calibration curve. By default this is turned off as calibrations outside of the range of the calibration curve can cause severe issues with probability ranges of calibrated dates</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Cut-off point for density calculation. A value of eps&gt;0 removes ages from the output which have negligible probability density</p></dd>


<dt id="arg-dfs">dfs<a class="anchor" aria-label="anchor" href="#arg-dfs"></a></dt>
<dd><p>Degrees-of-freedom values for the t-distribution associated with the calibration calculation. A large value indicates Gaussian distributions assumed for the 14C ages</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of lists where each element corresponds to a single age. Each element contains:</p><dl><dt>ages</dt>
<dd><p>The original age supplied</p></dd>

 <dt>ageSds</dt>
<dd><p>The original age standard deviation supplied</p></dd>

 <dt>positions</dt>
<dd><p>The position of the age (usually the depth)</p></dd>

 <dt>calCurves</dt>
<dd><p>The calibration curve used for that age</p></dd>

 <dt>ageGrid</dt>
<dd><p>A grid of age values over which the density was created</p></dd>

 <dt>densities</dt>
<dd><p>A vector of probability values indicating the probability value for each element in <code>ageGrid</code></p></dd>

 <dt>ageLab</dt>
<dd><p>The label given to the age variable</p></dd>

 <dt>positionLab</dt>
<dd><p>The label given to the position variable</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function provides a direct numerical integration strategy for computing calibrated radiocarbon ages. The steps for each 14C age are approximately as follows:
1) Create a grid of ages covering the range of the calibration curve
2) Calculate the probability of each age according to the 14C age, the standard deviation supplied and the calibration curve
3) Normalise the probabilities so that they sum to 1
4) Remove any probabilities that are less than the value given for eps
Multiple calibration curves can be specified so that each 14C age can have a different curve. For ages that are not 14C, use the 'normal' calibration curve which treats the ages as normally distributed with given standard deviation</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="Bchronology.html">Bchronology</a></code>, <code><a href="BchronRSL.html">BchronRSL</a></code>, <code><a href="BchronDensity.html">BchronDensity</a></code>, <code><a href="BchronDensityFast.html">BchronDensityFast</a></code>, <code><a href="createCalCurve.html">createCalCurve</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Calibrate a single age</span></span></span>
<span class="r-in"><span><span class="va">ages1</span> <span class="op">&lt;-</span> <span class="fu">BchronCalibrate</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ages <span class="op">=</span> <span class="fl">11553</span>,</span></span>
<span class="r-in"><span>  ageSds <span class="op">=</span> <span class="fl">230</span>,</span></span>
<span class="r-in"><span>  calCurves <span class="op">=</span> <span class="st">"intcal20"</span>,</span></span>
<span class="r-in"><span>  ids <span class="op">=</span> <span class="st">"Date-1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ages1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Highest density regions for Date-1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0.4%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13004 13025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`77.9%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13059 13874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`16.4%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13923 14012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ages1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="BchronCalibrate-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or plot with Calibration curve</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ages1</span>, includeCal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="BchronCalibrate-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calibrate multiple ages with different calibration curves</span></span></span>
<span class="r-in"><span><span class="va">ages2</span> <span class="op">&lt;-</span> <span class="fu">BchronCalibrate</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3445</span>, <span class="fl">11553</span>, <span class="fl">7456</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ageSds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">230</span>, <span class="fl">110</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  calCurves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intcal20"</span>, <span class="st">"intcal20"</span>, <span class="st">"shcal20"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ages2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Highest density regions for Date1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`94.4%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3572 3834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Highest density regions for Date2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0.4%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13004 13025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`77.9%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13059 13874</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`16.4%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13923 14012</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Highest density regions for Date3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`94.6%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8015 8409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ages2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-plt img"><img src="BchronCalibrate-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-plt img"><img src="BchronCalibrate-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-plt img"><img src="BchronCalibrate-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calibrate multiple ages with multiple calibration curves and including depth</span></span></span>
<span class="r-in"><span><span class="va">ages3</span> <span class="op">&lt;-</span> <span class="fu">BchronCalibrate</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3445</span>, <span class="fl">11553</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ageSds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">230</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  positions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  calCurves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"intcal20"</span>, <span class="st">"normal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ages3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Highest density regions for Date1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`94.4%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3572 3834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% Highest density regions for Date2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`94.7%`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11100 12005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ages3</span>, withPositions <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="BchronCalibrate-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andrew Parnell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

