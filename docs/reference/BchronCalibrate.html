<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast radiocarbon calibration — BchronCalibrate • Bchron</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fast radiocarbon calibration — BchronCalibrate" />
<meta property="og:description" content="A fast function for calibrating large numbers of radiocarbon dates involving multiple calibration curves" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bchron</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.7.5.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Bchron.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andrewcparnell/Bchron/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast radiocarbon calibration</h1>
    <small class="dont-index">Source: <a href='https://github.com/andrewcparnell/Bchron/blob/master/R/BchronCalibrate.R'><code>R/BchronCalibrate.R</code></a></small>
    <div class="hidden name"><code>BchronCalibrate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A fast function for calibrating large numbers of radiocarbon dates involving multiple calibration curves</p>
    </div>

    <pre class="usage"><span class='fu'>BchronCalibrate</span><span class='op'>(</span>
  <span class='va'>ages</span>,
  <span class='va'>ageSds</span>,
  calCurves <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"intcal20"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ages</span><span class='op'>)</span><span class='op'>)</span>,
  ids <span class='op'>=</span> <span class='cn'>NULL</span>,
  positions <span class='op'>=</span> <span class='cn'>NULL</span>,
  pathToCalCurves <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"data"</span>, package <span class='op'>=</span> <span class='st'>"Bchron"</span><span class='op'>)</span>,
  allowOutside <span class='op'>=</span> <span class='cn'>FALSE</span>,
  eps <span class='op'>=</span> <span class='fl'>1e-05</span>,
  dfs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ages</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ages</th>
      <td><p>A vector of ages provided in years before 1950.</p></td>
    </tr>
    <tr>
      <th>ageSds</th>
      <td><p>A vector of 1-sigma values for the ages given above</p></td>
    </tr>
    <tr>
      <th>calCurves</th>
      <td><p>A vector of values containing either <code>intcal20</code>, <code>shcal20</code>, <code>marine20</code>, or <code>normal</code> (older calibration curves are supposed such as intcal13). Should be the same length the number of ages supplied. Non-standard calibration curves can be used provided they are supplied in the same format as those previously mentioned and are placed in the same directory. Normal indicates a normally-distributed (non-14C) age.</p></td>
    </tr>
    <tr>
      <th>ids</th>
      <td><p>ID names for each age</p></td>
    </tr>
    <tr>
      <th>positions</th>
      <td><p>Position values (e.g. depths) for each age</p></td>
    </tr>
    <tr>
      <th>pathToCalCurves</th>
      <td><p>File path to where the calibration curves are located. Defaults to the system directory where the 3 standard calibration curves are stored.</p></td>
    </tr>
    <tr>
      <th>allowOutside</th>
      <td><p>Whether to allow calibrations to run outside the range of the calibration curve. By default this is turned off as calibrations outside of the range of the calibration curve can cause severe issues with probability ranges of calibrated dates</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>Cut-off point for density calculation. A value of eps&gt;0 removes ages from the output which have negligible probability density</p></td>
    </tr>
    <tr>
      <th>dfs</th>
      <td><p>Degrees-of-freedom values for the t-distribution associated with the calibration calculation. A large value indicates Gaussian distributions assumed for the 14C ages</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of lists where each element corresponds to a single age. Each element contains:</p>
<dt>ages</dt><dd><p>The original age supplied</p></dd>
 <dt>ageSds</dt><dd><p>The original age standard deviation supplied</p></dd>
 <dt>positions</dt><dd><p>The position of the age (usually the depth)</p></dd>
 <dt>calCurves</dt><dd><p>The calibration curve used for that age</p></dd>
 <dt>ageGrid</dt><dd><p>A grid of age values over which the density was created</p></dd>
 <dt>densities</dt><dd><p>A vector of probability values indicating the probability value for each element in <code>ageGrid</code></p></dd>
 <dt>ageLab</dt><dd><p>The label given to the age variable</p></dd>
 <dt>positionLab</dt><dd><p>The label given to the position variable</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function provides a direct numerical integration strategy for computing calibrated radiocarbon ages. The steps for each 14C age are approximately as follows:
1) Create a grid of ages covering the range of the calibration curve
2) Calculate the probability of each age according to the 14C age, the standard deviation supplied and the calibration curve
3) Normalise the probabilities so that they sum to 1
4) Remove any probabilities that are less than the value given for eps
Multiple calibration curves can be specified so that each 14C age can have a different curve. For ages that are not 14C, use the 'normal' calibration curve which treats the ages as normally distributed with given standard deviation</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='Bchronology.html'>Bchronology</a></code>, <code><a href='BchronRSL.html'>BchronRSL</a></code>, <code><a href='BchronDensity.html'>BchronDensity</a></code>, <code><a href='BchronDensityFast.html'>BchronDensityFast</a></code>, <code><a href='createCalCurve.html'>createCalCurve</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Calibrate a single age</span>
<span class='va'>ages1</span> <span class='op'>&lt;-</span> <span class='fu'>BchronCalibrate</span><span class='op'>(</span>
  ages <span class='op'>=</span> <span class='fl'>11553</span>,
  ageSds <span class='op'>=</span> <span class='fl'>230</span>,
  calCurves <span class='op'>=</span> <span class='st'>"intcal20"</span>,
  ids <span class='op'>=</span> <span class='st'>"Date-1"</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ages1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 95% Highest density regions for Date-1
#&gt; $`0.4%`
#&gt; [1] 13004 13025
#&gt; 
#&gt; $`77.9%`
#&gt; [1] 13059 13874
#&gt; 
#&gt; $`16.4%`
#&gt; [1] 13923 14012
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ages1</span><span class='op'>)</span>
</div><div class='img'><img src='BchronCalibrate-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Or plot with Calibration curve</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ages1</span>, includeCal <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='BchronCalibrate-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Calibrate multiple ages with different calibration curves</span>
<span class='va'>ages2</span> <span class='op'>&lt;-</span> <span class='fu'>BchronCalibrate</span><span class='op'>(</span>
  ages <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3445</span>, <span class='fl'>11553</span>, <span class='fl'>7456</span><span class='op'>)</span>,
  ageSds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>230</span>, <span class='fl'>110</span><span class='op'>)</span>,
  calCurves <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"intcal20"</span>, <span class='st'>"intcal20"</span>, <span class='st'>"shcal20"</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ages2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 95% Highest density regions for Date1
#&gt; $`94.4%`
#&gt; [1] 3572 3834
#&gt; 
#&gt; 
#&gt; 95% Highest density regions for Date2
#&gt; $`0.4%`
#&gt; [1] 13004 13025
#&gt; 
#&gt; $`77.9%`
#&gt; [1] 13059 13874
#&gt; 
#&gt; $`16.4%`
#&gt; [1] 13923 14012
#&gt; 
#&gt; 
#&gt; 95% Highest density regions for Date3
#&gt; $`94.6%`
#&gt; [1] 8015 8409
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ages2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]</div><div class='img'><img src='BchronCalibrate-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; [[2]]</div><div class='img'><img src='BchronCalibrate-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; [[3]]</div><div class='img'><img src='BchronCalibrate-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; </div><div class='input'>
<span class='co'># Calibrate multiple ages with multiple calibration curves and including depth</span>
<span class='va'>ages3</span> <span class='op'>&lt;-</span> <span class='fu'>BchronCalibrate</span><span class='op'>(</span>
  ages <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3445</span>, <span class='fl'>11553</span><span class='op'>)</span>,
  ageSds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>, <span class='fl'>230</span><span class='op'>)</span>,
  positions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>150</span><span class='op'>)</span>,
  calCurves <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"intcal20"</span>, <span class='st'>"normal"</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>ages3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 95% Highest density regions for Date1
#&gt; $`94.4%`
#&gt; [1] 3572 3834
#&gt; 
#&gt; 
#&gt; 95% Highest density regions for Date2
#&gt; $`94.7%`
#&gt; [1] 11100 12005
#&gt; 
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ages3</span>, withPositions <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='BchronCalibrate-6.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrew Parnell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


