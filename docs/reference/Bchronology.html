<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Runs the Compound Poisson-Gamma chronology model of Haslett and Parnell (2008) — Bchronology • Bchron</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Runs the Compound Poisson-Gamma chronology model of Haslett and Parnell (2008) — Bchronology" />
<meta property="og:description" content="Fits a non-parametric chronology model to age/position data according to the Compound Poisson-Gamma model defined by Haslett and Parnell (2008) &amp;lt;DOI:10.1111/j.1467-9876.2008.00623.x&amp;gt;. This version uses a slightly modified Markov chain Monte Carlo fitting algorithm which aims to converge quicker and requires fewer iterations. It also a slightly modified procedure for identifying outliers" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bchron</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.7.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Bchron.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andrewcparnell/Bchron/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Runs the Compound Poisson-Gamma chronology model of Haslett and Parnell (2008)</h1>
    <small class="dont-index">Source: <a href='https://github.com/andrewcparnell/Bchron/blob/master/R/Bchronology.R'><code>R/Bchronology.R</code></a></small>
    <div class="hidden name"><code>Bchronology.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits a non-parametric chronology model to age/position data according to the Compound Poisson-Gamma model defined by Haslett and Parnell (2008) &lt;DOI:10.1111/j.1467-9876.2008.00623.x&gt;. This version uses a slightly modified Markov chain Monte Carlo fitting algorithm which aims to converge quicker and requires fewer iterations. It also a slightly modified procedure for identifying outliers</p>
    </div>

    <pre class="usage"><span class='fu'>Bchronology</span><span class='op'>(</span>
  <span class='va'>ages</span>,
  <span class='va'>ageSds</span>,
  <span class='va'>positions</span>,
  positionThicknesses <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ages</span><span class='op'>)</span><span class='op'>)</span>,
  calCurves <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"intcal20"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ages</span><span class='op'>)</span><span class='op'>)</span>,
  ids <span class='op'>=</span> <span class='cn'>NULL</span>,
  outlierProbs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0.01</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>ages</span><span class='op'>)</span><span class='op'>)</span>,
  predictPositions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>positions</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>positions</span><span class='op'>)</span>, length <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>,
  pathToCalCurves <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"data"</span>, package <span class='op'>=</span> <span class='st'>"Bchron"</span><span class='op'>)</span>,
  jitterPositions <span class='op'>=</span> <span class='cn'>FALSE</span>,
  iterations <span class='op'>=</span> <span class='fl'>10000</span>,
  burn <span class='op'>=</span> <span class='fl'>2000</span>,
  thin <span class='op'>=</span> <span class='fl'>8</span>,
  extractDate <span class='op'>=</span> <span class='fl'>1950</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='st'>"%Y"</span><span class='op'>)</span><span class='op'>)</span>,
  maxExtrap <span class='op'>=</span> <span class='fl'>1000</span>,
  thetaMhSd <span class='op'>=</span> <span class='fl'>0.5</span>,
  muMhSd <span class='op'>=</span> <span class='fl'>0.1</span>,
  psiMhSd <span class='op'>=</span> <span class='fl'>0.1</span>,
  ageScaleVal <span class='op'>=</span> <span class='fl'>1000</span>,
  positionNormalise <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>ages</th>
      <td><p>A vector of ages (most likely 14C)</p></td>
    </tr>
    <tr>
      <th>ageSds</th>
      <td><p>A vector of 1-sigma values for the ages given above</p></td>
    </tr>
    <tr>
      <th>positions</th>
      <td><p>Position values (e.g. depths) for each age</p></td>
    </tr>
    <tr>
      <th>positionThicknesses</th>
      <td><p>Thickness values for each of the positions. The thickness value should be the full thickness value of the slice. By default set to zero.</p></td>
    </tr>
    <tr>
      <th>calCurves</th>
      <td><p>A vector of values containing either 'intcal20', 'shcal20', 'marine20', or 'normal' (older calibration curves are also supported, e.g. intcal13). Should be the same length the number of ages supplied. Non-standard calibration curves can be used provided they are supplied in the same format as those previously mentioned and are placed in the same directory, or created via <code><a href='createCalCurve.html'>createCalCurve</a></code>. Normal indicates a normally-distributed (non-14C) age.</p></td>
    </tr>
    <tr>
      <th>ids</th>
      <td><p>ID names for each age</p></td>
    </tr>
    <tr>
      <th>outlierProbs</th>
      <td><p>A vector of prior outlier probabilities, one for each age. Defaults to 0.01</p></td>
    </tr>
    <tr>
      <th>predictPositions</th>
      <td><p>A vector of positions (e.g. depths) at which predicted age values are required. Defaults to a sequence of length 100 from the top position to the bottom position</p></td>
    </tr>
    <tr>
      <th>pathToCalCurves</th>
      <td><p>File path to where the calibration curves are located. Defaults to the system directory where the 3 standard calibration curves are stored.</p></td>
    </tr>
    <tr>
      <th>jitterPositions</th>
      <td><p>Whether to jigger the positions at startup or not. Default is FALSE but if there are lots of dates at similar depths this may resolve some initialisation problems</p></td>
    </tr>
    <tr>
      <th>iterations</th>
      <td><p>The number of iterations to run the procedure for</p></td>
    </tr>
    <tr>
      <th>burn</th>
      <td><p>The number of starting iterations to discard</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>The step size for every iteration to keep beyond the burnin</p></td>
    </tr>
    <tr>
      <th>extractDate</th>
      <td><p>The top age of the core. Used for extrapolation purposes so that no extrapolated ages go beyond the top age of the core. Defaults to the current year</p></td>
    </tr>
    <tr>
      <th>maxExtrap</th>
      <td><p>The maximum number of extrapolations to perform before giving up and setting the predicted ages to NA. Useful for when large amounts of extrapolation are required, i.e. some of the predictPositions are a long way from the dated positions</p></td>
    </tr>
    <tr>
      <th>thetaMhSd</th>
      <td><p>The Metropolis-Hastings standard deviation for the age parameters</p></td>
    </tr>
    <tr>
      <th>muMhSd</th>
      <td><p>The Metropolis-Hastings standard deviation for the Compound Poisson-Gamma mean</p></td>
    </tr>
    <tr>
      <th>psiMhSd</th>
      <td><p>The Metropolis-Hastings standard deviation for the Compound Poisson-Gamma scale</p></td>
    </tr>
    <tr>
      <th>ageScaleVal</th>
      <td><p>A scale value for the ages. <code>Bchronology</code> works best when the ages are scaled to be approximately between 0 and 100. The default value is thus 1000 for ages given in years.</p></td>
    </tr>
    <tr>
      <th>positionNormalise</th>
      <td><p>Whether to normalise the position values. <code>Bchronology</code> works best when the positions are normalise to be between 0 and 1 The default value is <code>TRUE</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>BchronologyRun</code> which include elements:</p>
<dt>theta</dt><dd><p>The posterior estimated values of the ages</p></dd>
 <dt>phi</dt><dd><p>The posterior estimated outlier values (1=outlier, 2=not outlier). The means of this parameter give the posterior estimated outlier probabilities</p></dd>
 <dt>mu</dt><dd><p>The posterior values of the Compound Poisson-Gamma mean</p></dd>
 <dt>psi</dt><dd><p>The posterior values of the Compound Poisson-Gamma scale</p></dd>
 <dt>thetaPredict</dt><dd><p>The posterior estimated ages for each of the values in predictPosition</p></dd>
 <dt>predictPositions</dt><dd><p>The positions at which estimated ages were required</p></dd>
 <dt>calAges</dt><dd><p>The calibrated ages as output from <code><a href='BchronCalibrate.html'>BchronCalibrate</a></code></p></dd>
 <dt>inputVals</dt><dd><p>All of the input values to the <code>Bchronology</code> run</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>Bchronology</code> function fits a compound Poisson-Gamma distribution to the increments between the dated levels. This involves a stochastic linear interpolation step where the age gaps are Gamma distributed, and the position gaps are Exponential. Radiocarbon and non-radiocarbon dates (including outliers) are updated within the function also by MCMC.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Haslett, J., and Parnell, A. C. (2008). A simple monotone process with application to radiocarbon-dated depth chronologies. Journal of the Royal Statistical Society, Series C, 57, 399-418. DOI:10.1111/j.1467-9876.2008.00623.x
Parnell, A. C., Haslett, J., Allen, J. R. M., Buck, C. E., and Huntley, B. (2008). A flexible approach to assessing synchroneity of past events using Bayesian reconstructions of sedimentation history. Quaternary Science Reviews, 27(19-20), 1872-1885. DOI:10.1016/j.quascirev.2008.07.009</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='BchronCalibrate.html'>BchronCalibrate</a></code>, <code><a href='BchronRSL.html'>BchronRSL</a></code>, <code><a href='BchronDensity.html'>BchronDensity</a></code>, <code><a href='BchronDensityFast.html'>BchronDensityFast</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andrew Parnell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


